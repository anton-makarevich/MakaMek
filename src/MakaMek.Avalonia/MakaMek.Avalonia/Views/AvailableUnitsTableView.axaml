<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:wrappers="clr-namespace:Sanet.MakaMek.Presentation.ViewModels.Wrappers;assembly=Sanet.MakaMek.Presentation"
             xmlns:templatedControls="clr-namespace:Sanet.MakaMek.Avalonia.Views.TemplatedControls"
             xmlns:viewModels="clr-namespace:Sanet.MakaMek.Presentation.ViewModels;assembly=Sanet.MakaMek.Presentation"
             mc:Ignorable="d" d:DesignWidth="800" d:DesignHeight="600"
             x:Class="Sanet.MakaMek.Avalonia.Views.AvailableUnitsTableView"
             x:DataType="viewModels:AvailableUnitsTableViewModel">
    
    <!-- Centered dialog panel -->
    <templatedControls:GamePanel
        HorizontalAlignment="Center"
        VerticalAlignment="Center"
        Title="Available Units"
        CloseCommand="{Binding CancelCommand}">
        
        <Border Padding="5">
            <Grid RowDefinitions="Auto,Auto,*,Auto">
                <!-- Filter Controls -->
                <Grid Grid.Row="1"
                      ColumnDefinitions="Auto,*"
                      Margin="0,0,0,10">
                    <TextBlock Grid.Column="0"
                               Text="Class:"
                               Classes="label"
                               VerticalAlignment="Center"
                               Margin="0,0,10,0"/>
                    <ComboBox Grid.Column="1"
                              ItemsSource="{Binding WeightClassFilters}"
                              SelectedItem="{Binding SelectedWeightClassFilterString, Mode=TwoWay}"
                              HorizontalAlignment="Stretch">
                        <ComboBox.ItemTemplate>
                            <DataTemplate>
                                <TextBlock Text="{Binding}" Classes="body"/>
                            </DataTemplate>
                        </ComboBox.ItemTemplate>
                    </ComboBox>
                </Grid>
                
                <!-- Units Table -->
                <Border Grid.Row="2"
                        BorderBrush="{StaticResource PrimaryBrush}"
                        BorderThickness="1"
                        CornerRadius="4">
                    <Grid RowDefinitions="Auto,*">
                        <!-- Table Header -->
                        <Grid Grid.Row="0"
                              ColumnDefinitions="2*,2*,*"
                              Background="{StaticResource PrimaryBrush}"
                              Height="30">
                            <!-- Chassis -->
                            <Button Grid.Column="0"
                                    Command="{Binding SortByNameCommand}"
                                    Background="Transparent"
                                    BorderThickness="0"
                                    HorizontalAlignment="Stretch"
                                    HorizontalContentAlignment="Left">
                                <StackPanel Orientation="Horizontal" Spacing="5">
                                    <TextBlock Text="Chassis"
                                               Classes="label"
                                               Foreground="{StaticResource HighlightLightBrush}"
                                               FontWeight="Bold"
                                               VerticalAlignment="Center"/>
                                    <TextBlock Text="{Binding NameSortIndicator}"
                                               Classes="label"
                                               Foreground="{StaticResource HighlightLightBrush}"
                                               FontWeight="Bold"
                                               VerticalAlignment="Center"/>
                                </StackPanel>
                            </Button>
                            <TextBlock Grid.Column="1"
                                       Text="Model"
                                       Classes="label"
                                       Foreground="{StaticResource HighlightLightBrush}"
                                       FontWeight="Bold"
                                       VerticalAlignment="Center"
                                       Margin="10,0"/>
                            <!-- Tonnage Column Header -->
                            <Button Grid.Column="2"
                                    Command="{Binding SortByTonnageCommand}"
                                    Background="Transparent"
                                    BorderThickness="0"
                                    HorizontalAlignment="Stretch"
                                    HorizontalContentAlignment="Left">
                                <StackPanel Orientation="Horizontal" Spacing="5">
                                    <TextBlock Text="Mass"
                                               Classes="label"
                                               Foreground="{StaticResource HighlightLightBrush}"
                                               FontWeight="Bold"
                                               VerticalAlignment="Center"/>
                                    <TextBlock Text="{Binding TonnageSortIndicator}"
                                               Classes="label"
                                               Foreground="{StaticResource HighlightLightBrush}"
                                               FontWeight="Bold"
                                               VerticalAlignment="Center"/>
                                </StackPanel>
                            </Button>
                        </Grid>

                        <!-- Table Content -->
                        <ScrollViewer Grid.Row="1"
                                      HorizontalScrollBarVisibility="Auto"
                                      VerticalScrollBarVisibility="Auto">
                            <ListBox ItemsSource="{Binding FilteredAvailableUnits}"
                                     SelectedItem="{Binding SelectedUnit, Mode=TwoWay}"
                                     Background="Transparent"
                                     BorderThickness="0">
                                <ListBox.ItemTemplate>
                                    <DataTemplate>
                                        <Grid ColumnDefinitions="2*,2*,*"
                                              MinHeight="30">
                                            <TextBlock Grid.Column="0"
                                                       Text="{Binding Chassis}"
                                                       Classes="body"
                                                       VerticalAlignment="Center"
                                                       Margin="10,5"/>
                                            <TextBlock Grid.Column="1"
                                                       Text="{Binding Model}"
                                                       Classes="body"
                                                       VerticalAlignment="Center"
                                                       Margin="10,5"/>
                                            <TextBlock Grid.Column="2"
                                                       Text="{Binding Mass}"
                                                       Classes="body"
                                                       VerticalAlignment="Center"
                                                       Margin="10,5"/>
                                        </Grid>
                                    </DataTemplate>
                                </ListBox.ItemTemplate>
                            </ListBox>
                        </ScrollViewer>
                    </Grid>
                </Border>

                <!-- Action Buttons -->
                <StackPanel Grid.Row="3"
                            Orientation="Horizontal"
                            Spacing="10"
                            HorizontalAlignment="Right"
                            Margin="0,10,0,0">
                    <Button Content="Cancel"
                            Command="{Binding CancelCommand}"
                            Classes="secondary"/>
                    <Button Content="Add Unit"
                            Command="{Binding AddUnitCommand}"
                            IsEnabled="{Binding CanAddUnit}"
                            Classes="primary"/>
                </StackPanel>
            </Grid>
        </Border>
    </templatedControls:GamePanel>
</UserControl>

